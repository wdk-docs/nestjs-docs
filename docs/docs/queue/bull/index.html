
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="æœ€å¿«ã€æœ€å¯é ã€åŸºäºredisçš„Nodeé˜Ÿåˆ—ã€‚ ä»”ç»†å†™çš„å²©çŸ³å›ºä½“çš„ç¨³å®šæ€§å’ŒåŸå­æ€§ã€‚">
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.16">
    
    
      
        <title>bull - NestJs æ–‡æ¡£</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.1c3799f8.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cc9b2e1e.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#bull" class="md-skip">
          è·³è½¬è‡³
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰">
    <a href="../../.." title="NestJs æ–‡æ¡£" class="md-header__button md-logo" aria-label="NestJs æ–‡æ¡£" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NestJs æ–‡æ¡£
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              bull
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="æœç´¢" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="æŸ¥æ‰¾">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="æ¸…ç©ºå½“å‰å†…å®¹" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="å¯¼èˆªæ " data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="NestJs æ–‡æ¡£" class="md-nav__button md-logo" aria-label="NestJs æ–‡æ¡£" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    NestJs æ–‡æ¡£
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Blog
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Blog" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Blog
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/61.circular-dependencies/" class="md-nav__link">
        å¤„ç†å¾ªç¯ä¾èµ–é¡¹
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/_index/" class="md-nav__link">
        åšå®¢
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/applying-solid-principles-to-your-typescript-code/" class="md-nav__link">
        å¯¹typescriptä»£ç åº”ç”¨å¯é çš„åŸåˆ™
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/jwt-authentication-using-node-nestjs-mongoose-passport-ionic5-part1/" class="md-nav__link">
        JWT Authentication using node(Nestjs),Mongoose,Passport,ionic5 .. PART1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/nestjs-file-uploading-using-multer/" class="md-nav__link">
        Nestjsä½¿ç”¨Multerä¸Šä¼ æ–‡ä»¶
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/scalable-websockets-with-nestjs-and-redis/" class="md-nav__link">
        ä½¿ç”¨ NestJS å’Œ Redis æ‰©å±• WebSockets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/websocket-cluster-with-nestjs-and-redis/" class="md-nav__link">
        WebSocket cluster with NestJs and Redis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Docs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Docs" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../_index/" class="md-nav__link">
        æ–‡æ¡£
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../awesome/" class="md-nav__link">
        awesome
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_3">
          Compodoc
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Compodoc" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Compodoc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/_index/" class="md-nav__link">
        Compodoc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/comments/" class="md-nav__link">
        æ³¨é‡Š
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/demo/" class="md-nav__link">
        ç°åœºæ¼”ç¤º
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/documentation-coverage/" class="md-nav__link">
        æ–‡æ¡£è¦†ç›–
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/extensions/" class="md-nav__link">
        æ‰©å±•
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/features/" class="md-nav__link">
        ç‰¹æ€§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/hosting/" class="md-nav__link">
        æ‰˜ç®¡
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/installation/" class="md-nav__link">
        å®‰è£…
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/jsdoc-tags/" class="md-nav__link">
        JSDoc æ ‡ç­¾
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/live-example-tab/" class="md-nav__link">
        ç°åœºä¾‹å­é€‰é¡¹å¡
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/miscellaneous/" class="md-nav__link">
        æ‚é¡¹
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/options/" class="md-nav__link">
        é€‰é¡¹
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/routing/" class="md-nav__link">
        è·¯ç”±
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/tab-configuration/" class="md-nav__link">
        é€‰é¡¹å¡é…ç½®
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/themes/" class="md-nav__link">
        ä¸»é¢˜
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/tips-and-tricks/" class="md-nav__link">
        æç¤ºå’ŒæŠ€å·§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/tutorial/" class="md-nav__link">
        æ•™ç¨‹
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compodoc/usage/" class="md-nav__link">
        ä½¿ç”¨
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_4">
          Files
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Files" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          Files
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../files/_index/" class="md-nav__link">
        files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../files/api-nestjs-uploading-files-to-server/" class="md-nav__link">
        Uploading files to the server
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" type="checkbox" id="__nav_2_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_5">
          Http
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Http" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          Http
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../http/_index/" class="md-nav__link">
        http
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../http/api-nestjs-error-handling-validation/" class="md-nav__link">
        é”™è¯¯å¤„ç†å’Œæ•°æ®éªŒè¯
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../http/api-nestjs-stripe-events-webhooks/" class="md-nav__link">
        ç”¨webhookå¯¹Stripeäº‹ä»¶åšå‡ºååº”
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../http/axios-auth-refresh/" class="md-nav__link">
        axios-auth-refresh
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../http/axios/" class="md-nav__link">
        axios
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../http/nest-axios-interceptor/" class="md-nav__link">
        @narando/nest-axios-interceptor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../http/node-cache-manager/" class="md-nav__link">
        node-cache-manager - çµæ´»çš„NodeJSç¼“å­˜æ¨¡å—
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6" type="checkbox" id="__nav_2_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_6">
          Logs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Logs" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          Logs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../logs/_index/" class="md-nav__link">
        logs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../logs/api-nestjs-logging-typeorm/" class="md-nav__link">
        ä»‹ç»ä½¿ç”¨å†…ç½®è®°å½•å™¨å’ŒTypeORMè¿›è¡Œæ—¥å¿—è®°å½•
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_7" type="checkbox" id="__nav_2_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_7">
          Mongodb
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Mongodb" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_7">
          <span class="md-nav__icon md-icon"></span>
          Mongodb
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mongodb/_index/" class="md-nav__link">
        mongodb
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mongodb/indexes/" class="md-nav__link">
        ä½¿ç”¨MongoDBå’ŒMongooseå®šä¹‰ç´¢å¼•
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mongodb/introduction/" class="md-nav__link">
        MongoDBæ¦‚è®º
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mongodb/pagination/" class="md-nav__link">
        ä½¿ç”¨MongoDBå’ŒMongooseå®ç°åˆ†é¡µ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mongodb/relationships/" class="md-nav__link">
        å®ç°ä¸MongoDBçš„å…³ç³»
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mongodb/transactions/" class="md-nav__link">
        ä¸MongoDBå’ŒMongooseç®¡ç†äº‹åŠ¡
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mongodb/typescript-express-put-vs-patch-mongodb-mongoose/" class="md-nav__link">
        MongoDBä¸Mongooseä½¿ç”¨PUT vs PATCH
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mongodb/updating/" class="md-nav__link">
        ç”¨PUTå’ŒPATCHæ›´æ–°MongoDBå’ŒMongoose
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mongodb/virtual/" class="md-nav__link">
        MongoDBå’ŒMongooseçš„è™šæ‹Ÿå±æ€§
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_8" type="checkbox" id="__nav_2_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_8">
          Openapi
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Openapi" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_8">
          <span class="md-nav__icon md-icon"></span>
          Openapi
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openapi/_index/" class="md-nav__link">
        OpenAPI-swagger
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openapi/api-nestjs-openapi-swagger/" class="md-nav__link">
        OpenAPIè§„èŒƒå’ŒSwagger
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_9" type="checkbox" id="__nav_2_9" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2_9">
          Queue
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Queue" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_9">
          <span class="md-nav__icon md-icon"></span>
          Queue
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../_index/" class="md-nav__link">
        é˜Ÿåˆ—
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          bull
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        bull
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bull" class="md-nav__link">
    Bull ç‰¹æ€§
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uis" class="md-nav__link">
    UIs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    ç›‘æµ‹å’ŒæŠ¥è­¦
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    ç‰¹å¾æ¯”è¾ƒ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    å®‰è£…
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#typescript" class="md-nav__link">
    Typescript å®šä¹‰
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    å¿«é€ŸæŒ‡å—
  </a>
  
    <nav class="md-nav" aria-label="å¿«é€ŸæŒ‡å—">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    åŸºæœ¬ç”¨æ³•
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    ä½¿ç”¨æ‰¿è¯º
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    ç‹¬ç«‹çš„è¿›ç¨‹
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    é‡å¤çš„å·¥ä½œ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    æš‚åœ/æ¢å¤
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    äº‹ä»¶
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    é˜Ÿåˆ—æ€§èƒ½
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    é›†ç¾¤çš„æ”¯æŒ
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    æ–‡æ¡£
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    é‡è¦çš„ç¬”è®°
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    è°åœ¨ä½¿ç”¨
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bullmq" class="md-nav__link">
    BullMQ
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../guide/" class="md-nav__link">
        æŒ‡å—
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../patterns/" class="md-nav__link">
        æ¨¡å¼
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        å‚è€ƒ
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_10" type="checkbox" id="__nav_2_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_10">
          Validator
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Validator" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_10">
          <span class="md-nav__icon md-icon"></span>
          Validator
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../validator/_index/" class="md-nav__link">
        validator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../validator/class-transformer/" class="md-nav__link">
        class-transformer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../validator/class-validator/" class="md-nav__link">
        class-validator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bull" class="md-nav__link">
    Bull ç‰¹æ€§
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uis" class="md-nav__link">
    UIs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    ç›‘æµ‹å’ŒæŠ¥è­¦
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    ç‰¹å¾æ¯”è¾ƒ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    å®‰è£…
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#typescript" class="md-nav__link">
    Typescript å®šä¹‰
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    å¿«é€ŸæŒ‡å—
  </a>
  
    <nav class="md-nav" aria-label="å¿«é€ŸæŒ‡å—">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    åŸºæœ¬ç”¨æ³•
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    ä½¿ç”¨æ‰¿è¯º
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    ç‹¬ç«‹çš„è¿›ç¨‹
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    é‡å¤çš„å·¥ä½œ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    æš‚åœ/æ¢å¤
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    äº‹ä»¶
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    é˜Ÿåˆ—æ€§èƒ½
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    é›†ç¾¤çš„æ”¯æŒ
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    æ–‡æ¡£
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    é‡è¦çš„ç¬”è®°
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    è°åœ¨ä½¿ç”¨
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bullmq" class="md-nav__link">
    BullMQ
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


  <h1>bull</h1>

<blockquote>
<p>https://github.com/OptimalBits/bull</p>
</blockquote>
<p>è¯·åœ¨<a href="http://twitter.com/manast">ğŸ“»Twitter</a>ä¸Šå…³æ³¨æˆ‘ï¼Œäº†è§£é‡è¦çš„æ–°é—»å’Œæ›´æ–°ã€‚
ä½ å¯ä»¥åœ¨è¿™ä¸ªåšå®¢ä¸­æ‰¾åˆ°æ•™ç¨‹å’Œæ–°é—»: <a href="https://blog.taskforce.sh/">ğŸ›  æ•™ç¨‹</a></p>
<h3 id="bull">Bull ç‰¹æ€§</h3>
<ul>
<li>[x] æœ€å°çš„ CPU ä½¿ç”¨ç‡ï¼Œç”±äºæ— è½®è¯¢è®¾è®¡ã€‚</li>
<li>[x] åŸºäº Redis çš„ç¨³å¥è®¾è®¡ã€‚</li>
<li>[x] å»¶è¿Ÿçš„å·¥ä½œã€‚</li>
<li>[x] æ ¹æ® cron è§„èŒƒå®‰æ’å’Œé‡å¤ä½œä¸šã€‚</li>
<li>[x] å¯¹å·¥ä½œçš„ç‡é™åˆ¶ã€‚</li>
<li>[x] é‡è¯•ã€‚</li>
<li>[x] ä¼˜å…ˆçº§ã€‚</li>
<li>[x] å¹¶å‘æ€§ã€‚</li>
<li>[x] æš‚åœ/æ¢å¤-å…¨å±€æˆ–æœ¬åœ°ã€‚</li>
<li>[x] æ¯ä¸ªé˜Ÿåˆ—æœ‰å¤šä¸ªä½œä¸šç±»å‹ã€‚</li>
<li>[x] çº¿ç¨‹(æ²™ç›’)å¤„ç†å‡½æ•°ã€‚</li>
<li>[x] ä»è¿›ç¨‹å´©æºƒä¸­è‡ªåŠ¨æ¢å¤ã€‚</li>
</ul>
<p>æ¥ä¸‹æ¥æ˜¯è·¯çº¿å›¾â€¦</p>
<ul>
<li>[ ] ä½œä¸šå®Œæˆç¡®è®¤(åŒæ—¶å¯ä»¥ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—<a href="https://github.com/OptimalBits/bull/blob/develop/PATTERNS.md#returning-job-completions">pattern</a>)ã€‚</li>
<li>[ ] çˆ¶å­çš„å·¥ä½œå…³ç³»ã€‚</li>
</ul>
<hr />
<h3 id="uis">UIs</h3>
<p>ä½ å¯ä»¥ä½¿ç”¨ä¸€äº›ç¬¬ä¸‰æ–¹ ui æ¥è¿›è¡Œç›‘æ§:</p>
<p><strong>BullMQ</strong></p>
<ul>
<li><a href="https://taskforce.sh">Taskforce</a></li>
</ul>
<p><strong>Bull v3</strong></p>
<ul>
<li><a href="https://taskforce.sh">Taskforce</a></li>
<li><a href="https://github.com/vcapretz/bull-board">bull-board</a></li>
<li><a href="https://github.com/darky/bull-repl">bull-repl</a></li>
<li><a href="https://github.com/s-r-x/bull-monitor">bull-monitor</a></li>
<li><a href="https://github.com/AbhilashJN/monitoro">Monitoro</a></li>
</ul>
<p><strong>Bull &lt;= v2</strong></p>
<ul>
<li><a href="https://github.com/ShaneK/Matador">Matador</a></li>
<li><a href="https://github.com/kfatehi/react-bull">react-bull</a></li>
<li><a href="https://github.com/Epharmix/Toureiro">Toureiro</a></li>
</ul>
<hr />
<h3 id="_1">ç›‘æµ‹å’ŒæŠ¥è­¦</h3>
<ul>
<li>ä½¿ç”¨ Prometheus <a href="https://github.com/UpHabit/bull_exporter">Bull Queue Exporter</a></li>
</ul>
<hr />
<h3 id="_2">ç‰¹å¾æ¯”è¾ƒ</h3>
<p>ç”±äºæœ‰ä¸€äº›ä½œä¸šé˜Ÿåˆ—è§£å†³æ–¹æ¡ˆï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªè¡¨æ¯”è¾ƒå®ƒä»¬:</p>
<table>
<thead>
<tr>
<th align="left">Feature</th>
<th align="center">Bullmq-Pro</th>
<th align="center">Bullmq</th>
<th align="center">Bull</th>
<th align="center">Kue</th>
<th>Bee</th>
<th>Agenda</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">åç«¯</td>
<td align="center">redis</td>
<td align="center">redis</td>
<td align="center">redis</td>
<td align="center">redis</td>
<td>redis</td>
<td>mongo</td>
</tr>
<tr>
<td align="left">è§‚å¯Ÿ</td>
<td align="center">âœ“</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td></td>
<td></td>
</tr>
<tr>
<td align="left">ç»„é€Ÿç‡é™åˆ¶</td>
<td align="center">âœ“</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td></td>
<td></td>
</tr>
<tr>
<td align="left">é›†ç¾¤æ”¯æŒ</td>
<td align="center">âœ“</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td></td>
<td></td>
</tr>
<tr>
<td align="left">çˆ¶/å­ä¾èµ–å…³ç³»</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
<td></td>
</tr>
<tr>
<td align="left">ä¼˜å…ˆçº§</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td></td>
<td>âœ“</td>
</tr>
<tr>
<td align="left">å¹¶å‘æ€§</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
<tr>
<td align="left">æ¼”ç¤ºå·¥ä½œ</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td></td>
<td>âœ“</td>
</tr>
<tr>
<td align="left">å…¨å±€äº‹ä»¶</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td></td>
<td></td>
</tr>
<tr>
<td align="left">é€Ÿåº¦é™åˆ¶å™¨</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center"></td>
<td></td>
<td></td>
</tr>
<tr>
<td align="left">æš‚åœ/æ¢å¤</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td></td>
<td></td>
</tr>
<tr>
<td align="left">æ²™ç®±å·¥äºº</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center"></td>
<td></td>
<td></td>
</tr>
<tr>
<td align="left">å¯é‡å¤çš„å·¥ä½œ</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center"></td>
<td></td>
<td>âœ“</td>
</tr>
<tr>
<td align="left">åŸå­æ“ä½œ</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center"></td>
<td>âœ“</td>
<td></td>
</tr>
<tr>
<td align="left">æŒä¹…æ€§</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
<tr>
<td align="left">ç”¨æˆ·ç•Œé¢</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
<td></td>
<td>âœ“</td>
</tr>
<tr>
<td align="left">ä¼˜åŒ–äº†</td>
<td align="center">Jobs / Messages</td>
<td align="center">Jobs / Messages</td>
<td align="center">Jobs / Messages</td>
<td align="center">Jobs</td>
<td>Messages</td>
<td>Jobs</td>
</tr>
</tbody>
</table>
<h3 id="_3">å®‰è£…</h3>
<div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos="1 "></span></a>npm install bull --save
</code></pre></div>
<p>æˆ–è€…</p>
<div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><a href="#__codelineno-1-1"><span class="linenos" data-linenos="1 "></span></a>yarn add bull
</code></pre></div>
<p><em><strong>è¦æ±‚:</strong> Bull éœ€è¦å¤§äºæˆ–ç­‰äº' 2.8.18 'çš„ Redis ç‰ˆæœ¬ã€‚</em></p>
<h3 id="typescript">Typescript å®šä¹‰</h3>
<div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><a href="#__codelineno-2-1"><span class="linenos" data-linenos="1 "></span></a>npm install @types/bull --save-dev
</code></pre></div>
<div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><a href="#__codelineno-3-1"><span class="linenos" data-linenos="1 "></span></a>yarn add --dev @types/bull
</code></pre></div>
<p>å®šä¹‰ç›®å‰ç»´æŠ¤åœ¨<a href="https://github.com/DefinitelyTyped/DefinitelyTyped/tree/master/types/bull">DefinitelyTyped</a> repo ä¸­ã€‚</p>
<h3 id="_4">å¿«é€ŸæŒ‡å—</h3>
<h4 id="_5">åŸºæœ¬ç”¨æ³•</h4>
<div class="highlight"><span class="filename">JavaScript</span><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><a href="#__codelineno-4-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kd">const</span><span class="w"> </span><span class="nx">Queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;bull&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><a href="#__codelineno-4-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><a href="#__codelineno-4-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="kd">const</span><span class="w"> </span><span class="nx">videoQueue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Queue</span><span class="p">(</span><span class="s2">&quot;video transcoding&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;redis://127.0.0.1:6379&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><a href="#__codelineno-4-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="kd">const</span><span class="w"> </span><span class="nx">audioQueue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Queue</span><span class="p">(</span><span class="s2">&quot;audio transcoding&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><a href="#__codelineno-4-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">  </span><span class="nx">redis</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">port</span><span class="o">:</span><span class="w"> </span><span class="mf">6379</span><span class="p">,</span><span class="w"> </span><span class="nx">host</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;foobared&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><a href="#__codelineno-4-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="p">});</span><span class="w"> </span><span class="c1">// Specify Redis connection using object</span><span class="w"></span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><a href="#__codelineno-4-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="kd">const</span><span class="w"> </span><span class="nx">imageQueue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Queue</span><span class="p">(</span><span class="s2">&quot;image transcoding&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><a href="#__codelineno-4-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="kd">const</span><span class="w"> </span><span class="nx">pdfQueue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Queue</span><span class="p">(</span><span class="s2">&quot;pdf transcoding&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><a href="#__codelineno-4-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><a href="#__codelineno-4-10"><span class="linenos" data-linenos="10 "></span></a><span class="nx">videoQueue</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">job</span><span class="p">,</span><span class="w"> </span><span class="nx">done</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><a href="#__codelineno-4-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">  </span><span class="c1">// job.data contains the custom data passed when the job was created</span><span class="w"></span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><a href="#__codelineno-4-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">  </span><span class="c1">// job.id contains id of this job.</span><span class="w"></span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a><a href="#__codelineno-4-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a><a href="#__codelineno-4-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">  </span><span class="c1">// transcode video asynchronously and report progress</span><span class="w"></span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a><a href="#__codelineno-4-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">  </span><span class="nx">job</span><span class="p">.</span><span class="nx">progress</span><span class="p">(</span><span class="mf">42</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a><a href="#__codelineno-4-16"><span class="linenos" data-linenos="16 "></span></a>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a><a href="#__codelineno-4-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">  </span><span class="c1">// call done when finished</span><span class="w"></span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a><a href="#__codelineno-4-18"><span class="linenos" data-linenos="18 "></span></a><span class="w">  </span><span class="nx">done</span><span class="p">();</span><span class="w"></span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a><a href="#__codelineno-4-19"><span class="linenos" data-linenos="19 "></span></a>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a><a href="#__codelineno-4-20"><span class="linenos" data-linenos="20 "></span></a><span class="w">  </span><span class="c1">// or give a error if error</span><span class="w"></span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a><a href="#__codelineno-4-21"><span class="linenos" data-linenos="21 "></span></a><span class="w">  </span><span class="nx">done</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;error transcoding&quot;</span><span class="p">));</span><span class="w"></span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a><a href="#__codelineno-4-22"><span class="linenos" data-linenos="22 "></span></a>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a><a href="#__codelineno-4-23"><span class="linenos" data-linenos="23 "></span></a><span class="w">  </span><span class="c1">// or pass it a result</span><span class="w"></span>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a><a href="#__codelineno-4-24"><span class="linenos" data-linenos="24 "></span></a><span class="w">  </span><span class="nx">done</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a><a href="#__codelineno-4-25"><span class="linenos" data-linenos="25 "></span></a><span class="w">    </span><span class="nx">framerate</span><span class="o">:</span><span class="w"> </span><span class="mf">29.5</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a><a href="#__codelineno-4-26"><span class="linenos" data-linenos="26 "></span></a><span class="w">    </span><span class="cm">/* etc...</span>
<a id="__codelineno-4-27" name="__codelineno-4-27"></a><a href="#__codelineno-4-27"><span class="linenos" data-linenos="27 "></span></a><span class="cm">     */</span><span class="w"></span>
<a id="__codelineno-4-28" name="__codelineno-4-28"></a><a href="#__codelineno-4-28"><span class="linenos" data-linenos="28 "></span></a><span class="w">  </span><span class="p">});</span><span class="w"></span>
<a id="__codelineno-4-29" name="__codelineno-4-29"></a><a href="#__codelineno-4-29"><span class="linenos" data-linenos="29 "></span></a>
<a id="__codelineno-4-30" name="__codelineno-4-30"></a><a href="#__codelineno-4-30"><span class="linenos" data-linenos="30 "></span></a><span class="w">  </span><span class="c1">// If the job throws an unhandled exception it is also handled correctly</span><span class="w"></span>
<a id="__codelineno-4-31" name="__codelineno-4-31"></a><a href="#__codelineno-4-31"><span class="linenos" data-linenos="31 "></span></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;some unexpected error&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-32" name="__codelineno-4-32"></a><a href="#__codelineno-4-32"><span class="linenos" data-linenos="32 "></span></a><span class="p">});</span><span class="w"></span>
<a id="__codelineno-4-33" name="__codelineno-4-33"></a><a href="#__codelineno-4-33"><span class="linenos" data-linenos="33 "></span></a>
<a id="__codelineno-4-34" name="__codelineno-4-34"></a><a href="#__codelineno-4-34"><span class="linenos" data-linenos="34 "></span></a><span class="nx">audioQueue</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">job</span><span class="p">,</span><span class="w"> </span><span class="nx">done</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-4-35" name="__codelineno-4-35"></a><a href="#__codelineno-4-35"><span class="linenos" data-linenos="35 "></span></a><span class="w">  </span><span class="c1">// transcode audio asynchronously and report progress</span><span class="w"></span>
<a id="__codelineno-4-36" name="__codelineno-4-36"></a><a href="#__codelineno-4-36"><span class="linenos" data-linenos="36 "></span></a><span class="w">  </span><span class="nx">job</span><span class="p">.</span><span class="nx">progress</span><span class="p">(</span><span class="mf">42</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-37" name="__codelineno-4-37"></a><a href="#__codelineno-4-37"><span class="linenos" data-linenos="37 "></span></a>
<a id="__codelineno-4-38" name="__codelineno-4-38"></a><a href="#__codelineno-4-38"><span class="linenos" data-linenos="38 "></span></a><span class="w">  </span><span class="c1">// call done when finished</span><span class="w"></span>
<a id="__codelineno-4-39" name="__codelineno-4-39"></a><a href="#__codelineno-4-39"><span class="linenos" data-linenos="39 "></span></a><span class="w">  </span><span class="nx">done</span><span class="p">();</span><span class="w"></span>
<a id="__codelineno-4-40" name="__codelineno-4-40"></a><a href="#__codelineno-4-40"><span class="linenos" data-linenos="40 "></span></a>
<a id="__codelineno-4-41" name="__codelineno-4-41"></a><a href="#__codelineno-4-41"><span class="linenos" data-linenos="41 "></span></a><span class="w">  </span><span class="c1">// or give a error if error</span><span class="w"></span>
<a id="__codelineno-4-42" name="__codelineno-4-42"></a><a href="#__codelineno-4-42"><span class="linenos" data-linenos="42 "></span></a><span class="w">  </span><span class="nx">done</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;error transcoding&quot;</span><span class="p">));</span><span class="w"></span>
<a id="__codelineno-4-43" name="__codelineno-4-43"></a><a href="#__codelineno-4-43"><span class="linenos" data-linenos="43 "></span></a>
<a id="__codelineno-4-44" name="__codelineno-4-44"></a><a href="#__codelineno-4-44"><span class="linenos" data-linenos="44 "></span></a><span class="w">  </span><span class="c1">// or pass it a result</span><span class="w"></span>
<a id="__codelineno-4-45" name="__codelineno-4-45"></a><a href="#__codelineno-4-45"><span class="linenos" data-linenos="45 "></span></a><span class="w">  </span><span class="nx">done</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-4-46" name="__codelineno-4-46"></a><a href="#__codelineno-4-46"><span class="linenos" data-linenos="46 "></span></a><span class="w">    </span><span class="nx">samplerate</span><span class="o">:</span><span class="w"> </span><span class="mf">48000</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-4-47" name="__codelineno-4-47"></a><a href="#__codelineno-4-47"><span class="linenos" data-linenos="47 "></span></a><span class="w">    </span><span class="cm">/* etc...</span>
<a id="__codelineno-4-48" name="__codelineno-4-48"></a><a href="#__codelineno-4-48"><span class="linenos" data-linenos="48 "></span></a><span class="cm">     */</span><span class="w"></span>
<a id="__codelineno-4-49" name="__codelineno-4-49"></a><a href="#__codelineno-4-49"><span class="linenos" data-linenos="49 "></span></a><span class="w">  </span><span class="p">});</span><span class="w"></span>
<a id="__codelineno-4-50" name="__codelineno-4-50"></a><a href="#__codelineno-4-50"><span class="linenos" data-linenos="50 "></span></a>
<a id="__codelineno-4-51" name="__codelineno-4-51"></a><a href="#__codelineno-4-51"><span class="linenos" data-linenos="51 "></span></a><span class="w">  </span><span class="c1">// If the job throws an unhandled exception it is also handled correctly</span><span class="w"></span>
<a id="__codelineno-4-52" name="__codelineno-4-52"></a><a href="#__codelineno-4-52"><span class="linenos" data-linenos="52 "></span></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;some unexpected error&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-53" name="__codelineno-4-53"></a><a href="#__codelineno-4-53"><span class="linenos" data-linenos="53 "></span></a><span class="p">});</span><span class="w"></span>
<a id="__codelineno-4-54" name="__codelineno-4-54"></a><a href="#__codelineno-4-54"><span class="linenos" data-linenos="54 "></span></a>
<a id="__codelineno-4-55" name="__codelineno-4-55"></a><a href="#__codelineno-4-55"><span class="linenos" data-linenos="55 "></span></a><span class="nx">imageQueue</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">job</span><span class="p">,</span><span class="w"> </span><span class="nx">done</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-4-56" name="__codelineno-4-56"></a><a href="#__codelineno-4-56"><span class="linenos" data-linenos="56 "></span></a><span class="w">  </span><span class="c1">// transcode image asynchronously and report progress</span><span class="w"></span>
<a id="__codelineno-4-57" name="__codelineno-4-57"></a><a href="#__codelineno-4-57"><span class="linenos" data-linenos="57 "></span></a><span class="w">  </span><span class="nx">job</span><span class="p">.</span><span class="nx">progress</span><span class="p">(</span><span class="mf">42</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-58" name="__codelineno-4-58"></a><a href="#__codelineno-4-58"><span class="linenos" data-linenos="58 "></span></a>
<a id="__codelineno-4-59" name="__codelineno-4-59"></a><a href="#__codelineno-4-59"><span class="linenos" data-linenos="59 "></span></a><span class="w">  </span><span class="c1">// call done when finished</span><span class="w"></span>
<a id="__codelineno-4-60" name="__codelineno-4-60"></a><a href="#__codelineno-4-60"><span class="linenos" data-linenos="60 "></span></a><span class="w">  </span><span class="nx">done</span><span class="p">();</span><span class="w"></span>
<a id="__codelineno-4-61" name="__codelineno-4-61"></a><a href="#__codelineno-4-61"><span class="linenos" data-linenos="61 "></span></a>
<a id="__codelineno-4-62" name="__codelineno-4-62"></a><a href="#__codelineno-4-62"><span class="linenos" data-linenos="62 "></span></a><span class="w">  </span><span class="c1">// or give a error if error</span><span class="w"></span>
<a id="__codelineno-4-63" name="__codelineno-4-63"></a><a href="#__codelineno-4-63"><span class="linenos" data-linenos="63 "></span></a><span class="w">  </span><span class="nx">done</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;error transcoding&quot;</span><span class="p">));</span><span class="w"></span>
<a id="__codelineno-4-64" name="__codelineno-4-64"></a><a href="#__codelineno-4-64"><span class="linenos" data-linenos="64 "></span></a>
<a id="__codelineno-4-65" name="__codelineno-4-65"></a><a href="#__codelineno-4-65"><span class="linenos" data-linenos="65 "></span></a><span class="w">  </span><span class="c1">// or pass it a result</span><span class="w"></span>
<a id="__codelineno-4-66" name="__codelineno-4-66"></a><a href="#__codelineno-4-66"><span class="linenos" data-linenos="66 "></span></a><span class="w">  </span><span class="nx">done</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-4-67" name="__codelineno-4-67"></a><a href="#__codelineno-4-67"><span class="linenos" data-linenos="67 "></span></a><span class="w">    </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="mf">1280</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-4-68" name="__codelineno-4-68"></a><a href="#__codelineno-4-68"><span class="linenos" data-linenos="68 "></span></a><span class="w">    </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">720</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-4-69" name="__codelineno-4-69"></a><a href="#__codelineno-4-69"><span class="linenos" data-linenos="69 "></span></a><span class="w">    </span><span class="cm">/* etc...</span>
<a id="__codelineno-4-70" name="__codelineno-4-70"></a><a href="#__codelineno-4-70"><span class="linenos" data-linenos="70 "></span></a><span class="cm">     */</span><span class="w"></span>
<a id="__codelineno-4-71" name="__codelineno-4-71"></a><a href="#__codelineno-4-71"><span class="linenos" data-linenos="71 "></span></a><span class="w">  </span><span class="p">});</span><span class="w"></span>
<a id="__codelineno-4-72" name="__codelineno-4-72"></a><a href="#__codelineno-4-72"><span class="linenos" data-linenos="72 "></span></a>
<a id="__codelineno-4-73" name="__codelineno-4-73"></a><a href="#__codelineno-4-73"><span class="linenos" data-linenos="73 "></span></a><span class="w">  </span><span class="c1">// If the job throws an unhandled exception it is also handled correctly</span><span class="w"></span>
<a id="__codelineno-4-74" name="__codelineno-4-74"></a><a href="#__codelineno-4-74"><span class="linenos" data-linenos="74 "></span></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;some unexpected error&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-75" name="__codelineno-4-75"></a><a href="#__codelineno-4-75"><span class="linenos" data-linenos="75 "></span></a><span class="p">});</span><span class="w"></span>
<a id="__codelineno-4-76" name="__codelineno-4-76"></a><a href="#__codelineno-4-76"><span class="linenos" data-linenos="76 "></span></a>
<a id="__codelineno-4-77" name="__codelineno-4-77"></a><a href="#__codelineno-4-77"><span class="linenos" data-linenos="77 "></span></a><span class="nx">pdfQueue</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">job</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-4-78" name="__codelineno-4-78"></a><a href="#__codelineno-4-78"><span class="linenos" data-linenos="78 "></span></a><span class="w">  </span><span class="c1">// Processors can also return promises instead of using the done callback</span><span class="w"></span>
<a id="__codelineno-4-79" name="__codelineno-4-79"></a><a href="#__codelineno-4-79"><span class="linenos" data-linenos="79 "></span></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">pdfAsyncProcessor</span><span class="p">();</span><span class="w"></span>
<a id="__codelineno-4-80" name="__codelineno-4-80"></a><a href="#__codelineno-4-80"><span class="linenos" data-linenos="80 "></span></a><span class="p">});</span><span class="w"></span>
<a id="__codelineno-4-81" name="__codelineno-4-81"></a><a href="#__codelineno-4-81"><span class="linenos" data-linenos="81 "></span></a>
<a id="__codelineno-4-82" name="__codelineno-4-82"></a><a href="#__codelineno-4-82"><span class="linenos" data-linenos="82 "></span></a><span class="nx">videoQueue</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span><span class="w"> </span><span class="nx">video</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;http://example.com/video1.mov&quot;</span><span class="w"> </span><span class="p">});</span><span class="w"></span>
<a id="__codelineno-4-83" name="__codelineno-4-83"></a><a href="#__codelineno-4-83"><span class="linenos" data-linenos="83 "></span></a><span class="nx">audioQueue</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span><span class="w"> </span><span class="nx">audio</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;http://example.com/audio1.mp3&quot;</span><span class="w"> </span><span class="p">});</span><span class="w"></span>
<a id="__codelineno-4-84" name="__codelineno-4-84"></a><a href="#__codelineno-4-84"><span class="linenos" data-linenos="84 "></span></a><span class="nx">imageQueue</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span><span class="w"> </span><span class="nx">image</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;http://example.com/image1.tiff&quot;</span><span class="w"> </span><span class="p">});</span><span class="w"></span>
</code></pre></div>
<h4 id="_6">ä½¿ç”¨æ‰¿è¯º</h4>
<p>æˆ–è€…ï¼Œä½ å¯ä»¥ä½¿ç”¨ return promises æ¥ä»£æ›¿<code>done</code>å›è°ƒ:</p>
<div class="highlight"><span class="filename">JavaScript</span><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><a href="#__codelineno-5-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="nx">videoQueue</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">job</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><a href="#__codelineno-5-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">  </span><span class="c1">// ä¸è¦å¿˜è®°åˆ é™¤doneå›è°ƒ!</span><span class="w"></span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><a href="#__codelineno-5-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">  </span><span class="c1">// ç®€å•åœ°å›æŠ¥ä¸€ä¸ªæ‰¿è¯º</span><span class="w"></span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><a href="#__codelineno-5-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">fetchVideo</span><span class="p">(</span><span class="nx">job</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">url</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">transcodeVideo</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><a href="#__codelineno-5-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><a href="#__codelineno-5-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">  </span><span class="c1">// å¤„ç†æ‰¿è¯ºæ‹’ç»</span><span class="w"></span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><a href="#__codelineno-5-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">Promise</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;error transcoding&quot;</span><span class="p">));</span><span class="w"></span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><a href="#__codelineno-5-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><a href="#__codelineno-5-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">  </span><span class="c1">// å°†æ‰¿è¯ºè§£æçš„å€¼ä¼ é€’ç»™â€œcompletedâ€äº‹ä»¶</span><span class="w"></span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><a href="#__codelineno-5-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">({</span><span class="w"></span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><a href="#__codelineno-5-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">    </span><span class="nx">framerate</span><span class="o">:</span><span class="w"> </span><span class="mf">29.5</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a><a href="#__codelineno-5-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">    </span><span class="cm">/* etc...</span>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a><a href="#__codelineno-5-13"><span class="linenos" data-linenos="13 "></span></a><span class="cm">     */</span><span class="w"></span>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a><a href="#__codelineno-5-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">  </span><span class="p">});</span><span class="w"></span>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a><a href="#__codelineno-5-15"><span class="linenos" data-linenos="15 "></span></a>
<a id="__codelineno-5-16" name="__codelineno-5-16"></a><a href="#__codelineno-5-16"><span class="linenos" data-linenos="16 "></span></a><span class="w">  </span><span class="c1">// å¦‚æœä½œä¸šæŠ›å‡ºä¸€ä¸ªæœªå¤„ç†çš„å¼‚å¸¸ï¼Œå®ƒä¹Ÿä¼šå¾—åˆ°æ­£ç¡®çš„å¤„ç†</span><span class="w"></span>
<a id="__codelineno-5-17" name="__codelineno-5-17"></a><a href="#__codelineno-5-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;some unexpected error&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-5-18" name="__codelineno-5-18"></a><a href="#__codelineno-5-18"><span class="linenos" data-linenos="18 "></span></a><span class="w">  </span><span class="c1">// ä¸€æ ·</span><span class="w"></span>
<a id="__codelineno-5-19" name="__codelineno-5-19"></a><a href="#__codelineno-5-19"><span class="linenos" data-linenos="19 "></span></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">Promise</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;some unexpected error&quot;</span><span class="p">));</span><span class="w"></span>
<a id="__codelineno-5-20" name="__codelineno-5-20"></a><a href="#__codelineno-5-20"><span class="linenos" data-linenos="20 "></span></a><span class="p">});</span><span class="w"></span>
</code></pre></div>
<h4 id="_7">ç‹¬ç«‹çš„è¿›ç¨‹</h4>
<p>è¿›ç¨‹å‡½æ•°ä¹Ÿå¯ä»¥åœ¨å•ç‹¬çš„è¿›ç¨‹ä¸­è¿è¡Œã€‚è¿™æœ‰å‡ ä¸ªå¥½å¤„:</p>
<ul>
<li>è¿™ä¸ªè¿›ç¨‹æ˜¯æ²™ç®±åŒ–çš„ï¼Œæ‰€ä»¥å³ä½¿å®ƒå´©æºƒäº†ï¼Œä¹Ÿä¸ä¼šå½±å“å·¥ä½œè¿›ç¨‹ã€‚</li>
<li>æ‚¨å¯ä»¥åœ¨ä¸å½±å“é˜Ÿåˆ—çš„æƒ…å†µä¸‹è¿è¡Œé˜»å¡ä»£ç (ä½œä¸šä¸ä¼šåœæ­¢)ã€‚</li>
<li>æ›´å¥½åœ°åˆ©ç”¨å¤šæ ¸ cpuã€‚</li>
<li>å‡å°‘ä¸ redis çš„è¿æ¥ã€‚</li>
</ul>
<p>ä¸ºäº†ä½¿ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œåªéœ€åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„å¤„ç†å™¨æ–‡ä»¶:</p>
<div class="highlight"><span class="filename">JavaScript</span><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><a href="#__codelineno-6-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1">// processor.js</span><span class="w"></span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><a href="#__codelineno-6-2"><span class="linenos" data-linenos="2 "></span></a><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">job</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><a href="#__codelineno-6-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">  </span><span class="c1">// åšä¸€äº›ç¹é‡çš„å·¥ä½œ</span><span class="w"></span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><a href="#__codelineno-6-4"><span class="linenos" data-linenos="4 "></span></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><a href="#__codelineno-6-5"><span class="linenos" data-linenos="5 "></span></a><span class="p">};</span><span class="w"></span>
</code></pre></div>
<p>ç„¶ååƒè¿™æ ·å®šä¹‰å¤„ç†å™¨:</p>
<div class="highlight"><span class="filename">JavaScript</span><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><a href="#__codelineno-7-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1">// å•æµç¨‹:</span><span class="w"></span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><a href="#__codelineno-7-2"><span class="linenos" data-linenos="2 "></span></a><span class="nx">queue</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="s2">&quot;/path/to/my/processor.js&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><a href="#__codelineno-7-3"><span class="linenos" data-linenos="3 "></span></a>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><a href="#__codelineno-7-4"><span class="linenos" data-linenos="4 "></span></a><span class="c1">// ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å¹¶å‘:</span><span class="w"></span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><a href="#__codelineno-7-5"><span class="linenos" data-linenos="5 "></span></a><span class="nx">queue</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;/path/to/my/processor.js&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><a href="#__codelineno-7-6"><span class="linenos" data-linenos="6 "></span></a>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><a href="#__codelineno-7-7"><span class="linenos" data-linenos="7 "></span></a><span class="c1">// å’ŒæŒ‡å®šçš„å¤„ç†å™¨:</span><span class="w"></span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a><a href="#__codelineno-7-8"><span class="linenos" data-linenos="8 "></span></a><span class="nx">queue</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="s2">&quot;my processor&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;/path/to/my/processor.js&quot;</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<h4 id="_8">é‡å¤çš„å·¥ä½œ</h4>
<p>ä½œä¸šå¯ä»¥è¢«æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ï¼Œå¹¶æ ¹æ® cron è§„èŒƒé‡å¤å¤„ç†:</p>
<div class="highlight"><span class="filename">JavaScript</span><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><a href="#__codelineno-8-1"><span class="linenos" data-linenos="1 "></span></a><span class="nx">paymentsQueue</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">job</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><a href="#__codelineno-8-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">  </span><span class="c1">// Check payments</span><span class="w"></span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><a href="#__codelineno-8-3"><span class="linenos" data-linenos="3 "></span></a><span class="p">});</span><span class="w"></span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><a href="#__codelineno-8-4"><span class="linenos" data-linenos="4 "></span></a>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a><a href="#__codelineno-8-5"><span class="linenos" data-linenos="5 "></span></a><span class="c1">// Repeat payment job once every day at 3:15 (am)</span><span class="w"></span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><a href="#__codelineno-8-6"><span class="linenos" data-linenos="6 "></span></a><span class="nx">paymentsQueue</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">paymentsData</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">repeat</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">cron</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;15 3 * * *&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">});</span><span class="w"></span>
</code></pre></div>
<p>ä½œä¸ºæç¤ºï¼Œè¯·æ£€æŸ¥è¿™é‡Œçš„è¡¨è¾¾å¼ï¼Œä»¥éªŒè¯å®ƒä»¬æ˜¯æ­£ç¡®çš„:<a href="https://crontab.cronhub.io">cron è¡¨è¾¾å¼ç”Ÿæˆå™¨</a></p>
<h4 id="_9">æš‚åœ/æ¢å¤</h4>
<p>ä¸€ä¸ªé˜Ÿåˆ—å¯ä»¥è¢«å…¨å±€æš‚åœå’Œæ¢å¤(ä¼ é€’ <code>true</code> æ¥æš‚åœè¿™ä¸ª worker çš„å¤„ç†):</p>
<div class="highlight"><span class="filename">JavaScript</span><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><a href="#__codelineno-9-1"><span class="linenos" data-linenos="1 "></span></a><span class="nx">queue</span><span class="p">.</span><span class="nx">pause</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><a href="#__codelineno-9-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">  </span><span class="c1">// queue is paused now</span><span class="w"></span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><a href="#__codelineno-9-3"><span class="linenos" data-linenos="3 "></span></a><span class="p">});</span><span class="w"></span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a><a href="#__codelineno-9-4"><span class="linenos" data-linenos="4 "></span></a>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a><a href="#__codelineno-9-5"><span class="linenos" data-linenos="5 "></span></a><span class="nx">queue</span><span class="p">.</span><span class="nx">resume</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-9-6" name="__codelineno-9-6"></a><a href="#__codelineno-9-6"><span class="linenos" data-linenos="6 "></span></a><span class="w">  </span><span class="c1">// queue is resumed now</span><span class="w"></span>
<a id="__codelineno-9-7" name="__codelineno-9-7"></a><a href="#__codelineno-9-7"><span class="linenos" data-linenos="7 "></span></a><span class="p">});</span><span class="w"></span>
</code></pre></div>
<h4 id="_10">äº‹ä»¶</h4>
<p>é˜Ÿåˆ—ä¼šå‘å‡ºä¸€äº›æœ‰ç”¨çš„äº‹ä»¶ï¼Œä¾‹å¦‚â€¦</p>
<div class="highlight"><span class="filename">JavaScript</span><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><a href="#__codelineno-10-1"><span class="linenos" data-linenos="1 "></span></a><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;completed&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">job</span><span class="p">,</span><span class="w"> </span><span class="nx">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><a href="#__codelineno-10-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">  </span><span class="c1">// Job completed with output result!</span><span class="w"></span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a><a href="#__codelineno-10-3"><span class="linenos" data-linenos="3 "></span></a><span class="p">})</span><span class="w"></span>
</code></pre></div>
<p>æœ‰å…³äº‹ä»¶çš„æ›´å¤šä¿¡æ¯ï¼ŒåŒ…æ‹¬æ‰€è§¦å‘äº‹ä»¶çš„å®Œæ•´åˆ—è¡¨ï¼Œè¯·å‚é˜…<a href="./REFERENCE.md#events">äº‹ä»¶å‚è€ƒèµ„æ–™</a></p>
<h4 id="_11">é˜Ÿåˆ—æ€§èƒ½</h4>
<p>é˜Ÿåˆ—å¾ˆä¾¿å®œï¼Œæ‰€ä»¥å¦‚æœä½ éœ€è¦å¾ˆå¤šé˜Ÿåˆ—ï¼Œåªéœ€åˆ›å»ºæ–°çš„ä¸åŒåç§°çš„é˜Ÿåˆ—:</p>
<div class="highlight"><span class="filename">JavaScript</span><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><a href="#__codelineno-11-1"><span class="linenos" data-linenos="1 "></span></a><span class="kd">const</span><span class="w"> </span><span class="nx">userJohn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Queue</span><span class="p">(</span><span class="s1">&#39;john&#39;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><a href="#__codelineno-11-2"><span class="linenos" data-linenos="2 "></span></a><span class="kd">const</span><span class="w"> </span><span class="nx">userLisa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Queue</span><span class="p">(</span><span class="s1">&#39;lisa&#39;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><a href="#__codelineno-11-3"><span class="linenos" data-linenos="3 "></span></a><span class="p">.</span><span class="w"></span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><a href="#__codelineno-11-4"><span class="linenos" data-linenos="4 "></span></a><span class="p">.</span><span class="w"></span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a><a href="#__codelineno-11-5"><span class="linenos" data-linenos="5 "></span></a><span class="p">.</span><span class="w"></span>
</code></pre></div>
<p>ç„¶è€Œï¼Œæ¯ä¸ªé˜Ÿåˆ—å®ä¾‹å°†éœ€è¦æ–°çš„ redis è¿æ¥ï¼Œæ£€æŸ¥å¦‚ä½•<a href="https://github.com/OptimalBits/bull/blob/master/PATTERNS.md#reusing-redis-connections">é‡ç”¨è¿æ¥</a>ï¼Œæˆ–è€…ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<a href="https://github.com/OptimalBits/bull/blob/master/REFERENCE.md#queueprocess">å‘½åå¤„ç†å™¨</a>æ¥å®ç°ç±»ä¼¼çš„ç»“æœã€‚</p>
<h4 id="_12">é›†ç¾¤çš„æ”¯æŒ</h4>
<blockquote>
<p>NOTE: ä» 3.2.0 åŠä»¥ä¸Šç‰ˆæœ¬å¼€å§‹ï¼Œå»ºè®®ä½¿ç”¨çº¿ç¨‹å¤„ç†å™¨ã€‚</p>
</blockquote>
<p>é˜Ÿåˆ—æ˜¯å¥å£®çš„ï¼Œå¯ä»¥åœ¨å‡ ä¸ªçº¿ç¨‹æˆ–è¿›ç¨‹ä¸­å¹¶è¡Œè¿è¡Œï¼Œæ²¡æœ‰ä»»ä½•å±é™©æˆ–é˜Ÿåˆ—æŸåçš„é£é™©ã€‚
æ£€æŸ¥è¿™ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½¿ç”¨ cluster è·¨è¿›ç¨‹å¹¶è¡ŒåŒ–ä»»åŠ¡:</p>
<div class="highlight"><span class="filename">JavaScript</span><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><a href="#__codelineno-12-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kd">const</span><span class="w"> </span><span class="nx">Queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;bull&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><a href="#__codelineno-12-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="kd">const</span><span class="w"> </span><span class="nx">cluster</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;cluster&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><a href="#__codelineno-12-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><a href="#__codelineno-12-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="kd">const</span><span class="w"> </span><span class="nx">numWorkers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><a href="#__codelineno-12-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="kd">const</span><span class="w"> </span><span class="nx">queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Queue</span><span class="p">(</span><span class="s2">&quot;test concurrent queue&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><a href="#__codelineno-12-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-12-7" name="__codelineno-12-7"></a><a href="#__codelineno-12-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">cluster</span><span class="p">.</span><span class="nx">isMaster</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-12-8" name="__codelineno-12-8"></a><a href="#__codelineno-12-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">numWorkers</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-12-9" name="__codelineno-12-9"></a><a href="#__codelineno-12-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">    </span><span class="nx">cluster</span><span class="p">.</span><span class="nx">fork</span><span class="p">();</span><span class="w"></span>
<a id="__codelineno-12-10" name="__codelineno-12-10"></a><a href="#__codelineno-12-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">  </span><span class="p">}</span><span class="w"></span>
<a id="__codelineno-12-11" name="__codelineno-12-11"></a><a href="#__codelineno-12-11"><span class="linenos" data-linenos="11 "></span></a>
<a id="__codelineno-12-12" name="__codelineno-12-12"></a><a href="#__codelineno-12-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">  </span><span class="nx">cluster</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;online&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">worker</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-12-13" name="__codelineno-12-13"></a><a href="#__codelineno-12-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">    </span><span class="c1">// Let&#39;s create a few jobs for the queue workers</span><span class="w"></span>
<a id="__codelineno-12-14" name="__codelineno-12-14"></a><a href="#__codelineno-12-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">500</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-12-15" name="__codelineno-12-15"></a><a href="#__codelineno-12-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">      </span><span class="nx">queue</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span><span class="w"> </span><span class="nx">foo</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;bar&quot;</span><span class="w"> </span><span class="p">});</span><span class="w"></span>
<a id="__codelineno-12-16" name="__codelineno-12-16"></a><a href="#__codelineno-12-16"><span class="linenos" data-linenos="16 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"></span>
<a id="__codelineno-12-17" name="__codelineno-12-17"></a><a href="#__codelineno-12-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">  </span><span class="p">});</span><span class="w"></span>
<a id="__codelineno-12-18" name="__codelineno-12-18"></a><a href="#__codelineno-12-18"><span class="linenos" data-linenos="18 "></span></a>
<a id="__codelineno-12-19" name="__codelineno-12-19"></a><a href="#__codelineno-12-19"><span class="linenos" data-linenos="19 "></span></a><span class="w">  </span><span class="nx">cluster</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;exit&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">worker</span><span class="p">,</span><span class="w"> </span><span class="nx">code</span><span class="p">,</span><span class="w"> </span><span class="nx">signal</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-12-20" name="__codelineno-12-20"></a><a href="#__codelineno-12-20"><span class="linenos" data-linenos="20 "></span></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;worker &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">worker</span><span class="p">.</span><span class="nx">process</span><span class="p">.</span><span class="nx">pid</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; died&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-12-21" name="__codelineno-12-21"></a><a href="#__codelineno-12-21"><span class="linenos" data-linenos="21 "></span></a><span class="w">  </span><span class="p">});</span><span class="w"></span>
<a id="__codelineno-12-22" name="__codelineno-12-22"></a><a href="#__codelineno-12-22"><span class="linenos" data-linenos="22 "></span></a><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-12-23" name="__codelineno-12-23"></a><a href="#__codelineno-12-23"><span class="linenos" data-linenos="23 "></span></a><span class="w">  </span><span class="nx">queue</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">job</span><span class="p">,</span><span class="w"> </span><span class="nx">jobDone</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-12-24" name="__codelineno-12-24"></a><a href="#__codelineno-12-24"><span class="linenos" data-linenos="24 "></span></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Job done by worker&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">cluster</span><span class="p">.</span><span class="nx">worker</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">job</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-12-25" name="__codelineno-12-25"></a><a href="#__codelineno-12-25"><span class="linenos" data-linenos="25 "></span></a><span class="w">    </span><span class="nx">jobDone</span><span class="p">();</span><span class="w"></span>
<a id="__codelineno-12-26" name="__codelineno-12-26"></a><a href="#__codelineno-12-26"><span class="linenos" data-linenos="26 "></span></a><span class="w">  </span><span class="p">});</span><span class="w"></span>
<a id="__codelineno-12-27" name="__codelineno-12-27"></a><a href="#__codelineno-12-27"><span class="linenos" data-linenos="27 "></span></a><span class="p">}</span><span class="w"></span>
</code></pre></div>
<hr />
<h3 id="_13">æ–‡æ¡£</h3>
<p>è¦è·å–å®Œæ•´çš„æ–‡æ¡£ï¼Œè¯·æŸ¥çœ‹å‚è€ƒå’Œå¸¸ç”¨æ¨¡å¼:</p>
<ul>
<li><a href="https://optimalbits.github.io/bull/">æŒ‡å—</a> - ä½ ä½¿ç”¨ Bull å¼€å‘çš„èµ·ç‚¹ã€‚</li>
<li><a href="./REFERENCE.md">å‚è€ƒ</a> - åŒ…å«æ‰€æœ‰å¯ç”¨å¯¹è±¡å’Œæ–¹æ³•çš„å¼•ç”¨æ–‡æ¡£ã€‚</li>
<li><a href="./PATTERNS.md">æ¨¡å¼</a> - ä¸€ç»„å¸¸è§æ¨¡å¼çš„ç¤ºä¾‹ã€‚</li>
<li><a href="./LICENSE.md">è®¸å¯è¯</a> - Bull è®¸å¯è¯-éº»çœç†å·¥å­¦é™¢ã€‚</li>
</ul>
<p>å¦‚æœä½ çœ‹åˆ°ä»»ä½•å¯ä»¥ä½¿ç”¨æ›´å¤šæ–‡æ¡£çš„ä¸œè¥¿ï¼Œè¯·æäº¤ä¸€ä¸ª pull request!</p>
<hr />
<h3 id="_14">é‡è¦çš„ç¬”è®°</h3>
<p>é˜Ÿåˆ—çš„ç›®æ ‡æ˜¯â€œè‡³å°‘ä¸€æ¬¡â€çš„å·¥ä½œç­–ç•¥ã€‚
è¿™æ„å‘³ç€åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸€ä¸ªä½œä¸šå¯èƒ½ä¼šè¢«å¤šæ¬¡å¤„ç†ã€‚
è¿™ç§æƒ…å†µé€šå¸¸å‘ç”Ÿåœ¨ä¸€ä¸ª worker åœ¨æ•´ä¸ªå¤„ç†è¿‡ç¨‹ä¸­æ²¡æœ‰ä¸ºç»™å®šçš„ä½œä¸šä¿æŒé”çš„æ—¶å€™ã€‚</p>
<p>å½“ä¸€ä¸ªå·¥äººæ­£åœ¨å¤„ç†ä¸€é¡¹å·¥ä½œæ—¶ï¼Œå®ƒå°†ä½¿è¯¥å·¥ä½œä¿æŒâ€œé”å®šâ€ï¼Œä»¥ä¾¿å…¶ä»–å·¥äººä¸èƒ½å¤„ç†å®ƒã€‚</p>
<p>ç†è§£é”å®šæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»¥é˜²æ­¢æ‚¨çš„ä½œä¸šå¤±å»é”- becoming <em>stalled</em> - å¹¶å› æ­¤é‡æ–°å¯åŠ¨ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚
é”æ˜¯é€šè¿‡åœ¨ <code>lockRenewTime</code> (é€šå¸¸æ˜¯ <code>lockDuration</code> çš„ä¸€åŠ)ä¸Šä¸º <code>lockDuration</code> åˆ›å»ºä¸€ä¸ªé”æ¥å®ç°çš„ã€‚
å¦‚æœ <code>lockDuration</code> åœ¨é”è¢«æ›´æ–°ä¹‹å‰è¿‡æœŸï¼Œåˆ™è¯¥ä½œä¸šå°†è¢«è§†ä¸ºæš‚åœå¹¶è‡ªåŠ¨é‡å¯;å®ƒå°†è¢«<strong>äºŒæ¬¡åŠ å·¥</strong>ã€‚</p>
<p>è¿™ç§æƒ…å†µå¯èƒ½å‘ç”Ÿåœ¨:</p>
<ol>
<li>è¿è¡Œä½œä¸šå¤„ç†å™¨çš„ Node è¿›ç¨‹æ„å¤–ç»ˆæ­¢ã€‚</li>
<li>æ‚¨çš„ä½œä¸šå¤„ç†å™¨ cpu è¿‡äºå¯†é›†ï¼Œå¯¼è‡´ Node äº‹ä»¶å¾ªç¯åœé¡¿ï¼Œç»“æœï¼ŒBull æ— æ³•æ›´æ–°ä½œä¸šé”(è¯·å‚é˜…<a href="https://github.com/OptimalBits/bull/issues/488">#488</a>äº†è§£å¦‚ä½•æ›´å¥½åœ°æ£€æµ‹æ­¤é—®é¢˜)ã€‚
   æ‚¨å¯ä»¥é€šè¿‡å°†ä½œä¸šå¤„ç†å™¨åˆ†è§£ä¸ºæ›´å°çš„éƒ¨åˆ†æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿™æ ·å•ä¸ªéƒ¨åˆ†å°±ä¸ä¼šé˜»å¡ Node äº‹ä»¶å¾ªç¯ã€‚
   æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä¸º <code>lockDuration</code> è®¾ç½®ä¼ é€’ä¸€ä¸ªæ›´å¤§çš„å€¼(ä»£ä»·æ˜¯å®ƒå°†èŠ±è´¹æ›´é•¿çš„æ—¶é—´æ¥è¯†åˆ«çœŸæ­£çš„æš‚åœä½œä¸š)ã€‚</li>
</ol>
<p>å› æ­¤ï¼Œæ‚¨åº”è¯¥å§‹ç»ˆä¾¦å¬ <code>stopped</code> äº‹ä»¶å¹¶å°†å…¶è®°å½•åˆ°é”™è¯¯ç›‘è§†ç³»ç»Ÿä¸­ï¼Œå› ä¸ºè¿™æ„å‘³ç€æ‚¨çš„ä½œä¸šå¯èƒ½ä¼šè¢«é‡å¤å¤„ç†ã€‚</p>
<p>ä½œä¸ºä¸€ç§å®‰å…¨æªæ–½ï¼Œæœ‰é—®é¢˜çš„ä½œä¸šä¸ä¼šè¢«æ— é™æœŸé‡å¯(ä¾‹å¦‚ï¼Œå¦‚æœä½œä¸šå¤„ç†å™¨æ€»æ˜¯å´©æºƒå®ƒçš„ Node è¿›ç¨‹)ï¼Œä½œä¸šå°†ä»åœæ­¢çŠ¶æ€æ¢å¤ï¼Œæœ€å¤§æ¬¡æ•°ä¸º <code>maxStalledCount</code> (é»˜è®¤ä¸º <code>1</code>)ã€‚</p>
<h3 id="_15">è°åœ¨ä½¿ç”¨</h3>
<p>Bull åœ¨å¤§å¤§å°å°çš„ç»„ç»‡ä¸­éƒ½å¾ˆå—æ¬¢è¿ï¼Œæ¯”å¦‚ä»¥ä¸‹è¿™äº›ç»„ç»‡:</p>
<table cellspacing="0" cellpadding="0">
  <tr>
    <td valign="center">
      <a href="https://github.com/atlassian/github-for-jira">
        <img
          src="https://876297641-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-LUuDmt_xXMfG66Rn1GA%2Fuploads%2FevsJCF6F1tx1ScZwDQOd%2FAtlassian-horizontal-blue-rgb.webp?alt=media&token=2fcd0528-e8bb-4bdd-af35-9d20e313d1a8"
          width="150"
          alt="Atlassian"
      /></a>
    </td>
    <td valign="center">
      <a href="https://github.com/Autodesk">
        <img
          src="https://876297641-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-LUuDmt_xXMfG66Rn1GA%2Fuploads%2FvpTe02RdOhUJBA8TdHEE%2Fautodesk-logo-white.png?alt=media&token=326961b4-ea4f-4ded-89a4-e05692eec8ee"
          width="150"
          alt="Autodesk"
      /></a>
    </td>
    <td valign="center">
      <a href="https://github.com/common-voice/common-voice">
        <img
          src="https://876297641-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-LUuDmt_xXMfG66Rn1GA%2Fuploads%2F4zPSrubNJKViAzUIftIy%2Fmozilla-logo-bw-rgb.png?alt=media&token=9f93aae2-833f-4cc4-8df9-b7fea0ad5cb5"
          width="150"
          alt="Mozilla"
      /></a>
    </td>
    <td valign="center">
      <a href="https://github.com/nestjs/bull">
        <img
          src="https://876297641-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-LUuDmt_xXMfG66Rn1GA%2Fuploads%2FfAcGye182utFUtPKdLqJ%2FScreenshot%202022-02-15%20at%2011.32.39.png?alt=media&token=29feb550-f0bc-467d-a290-f700701d7d15"
          width="150"
          alt="Nest"
      /></a>
    </td>
    <td valign="center">
      <a href="https://github.com/salesforce/refocus">
        <img
          src="https://876297641-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-LUuDmt_xXMfG66Rn1GA%2Fuploads%2FZNnYNuL5qJ6ZoBh7JJEW%2Fsalesforce-logo.png?alt=media&token=ddcae63b-08c0-4dd4-8496-3b29a9bf977d"
          width="100"
          alt="Salesforce"
      /></a>
    </td>

  </tr>
</table>

<hr />
<h3 id="bullmq">BullMQ</h3>
<p>å¦‚æœä½ æƒ³å¼€å§‹ä½¿ç”¨å®Œå…¨ç”¨ Typescript ç¼–å†™çš„ä¸‹ä¸€ä¸ªä¸»è¦ç‰ˆæœ¬çš„ Bullï¼Œæ¬¢è¿ä½¿ç”¨æ–°çš„ repo<a href="https://github.com/taskforcesh/bullmq">è¿™é‡Œ</a>.
å¦åˆ™ï¼Œæˆ‘ä»¬éå¸¸æ¬¢è¿ä½ ä»ç„¶ä½¿ç”¨ Bullï¼Œè¿™æ˜¯ä¸€ä¸ªå®‰å…¨çš„ã€ç»è¿‡æˆ˜æ–—æµ‹è¯•çš„ä»£ç åº“ã€‚</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="é¡µè„š">
      
        
        <a href="../_index/" class="md-footer__link md-footer__link--prev" aria-label="ä¸Šä¸€é¡µ: é˜Ÿåˆ—" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                ä¸Šä¸€é¡µ
              </span>
              é˜Ÿåˆ—
            </div>
          </div>
        </a>
      
      
        
        <a href="../guide/" class="md-footer__link md-footer__link--next" aria-label="ä¸‹ä¸€é¡µ: æŒ‡å—" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                ä¸‹ä¸€é¡µ
              </span>
              æŒ‡å—
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\s\\-\uff0c\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.3a4b43e5.min.js"></script>
      
    
  </body>
</html>